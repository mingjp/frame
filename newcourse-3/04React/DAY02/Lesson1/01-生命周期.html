<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Component</title>
	<!-- React 的核心库 -->
	<script type="text/javascript" src="../../../../libs/react/react.js"></script>
	<!-- 提供与 DOM 相关的功能 -->
	<script type="text/javascript" src="../../../../libs/react/react-dom.js"></script>
	<!-- 将 JSX 语法转为 JavaScript 语法 -->
	<script type="text/javascript" src="../../../../libs/react/browser.min.js"></script>

	<script type="text/javascript" src="../../../../libs/jquery/jquery-2.1.1.min.js"></script>

</head>
<body>
	<div id='div1'></div>
	<div id="div2"></div>
	<div id="div3"></div>

	<script type="text/babel">
		//div1
		// var Component4 = React.createClass({
		// 	getInitialState: function() {
		// 		return {value: 10, opacity: 0.5};
		// 	},
		// 	componentDidMount: function() {
		// 		this.timer = window.setInterval(function(){
		// 			var _value = this.state.value;
		// 			_value -= 1;
		// 			this.setState({value: _value});
		// 			if(_value <= 0){
		// 				window.clearInterval(this.timer);
		// 				this.timer = null;
		// 			};
		// 		}.bind(this), 1000);
		// 	},
		// 	render: function(){
		// 		return(
		// 			<div id="dk">
		// 				<p style={{opacity: this.state.opacity}}>{this.state.value}</p>
		// 			</div>
		// 		);
		// 	}
		// });
		// ReactDOM.render(<Component4/>, document.getElementById('div1'));

		// //div2
		// var Component5 = React.createClass({
		// 	getInitialState: function() {
		// 		return {name: 'Tom'};
		// 	},
		// 	componentDidMount: function() {
		// 		$.getJSON('demo.json', function(_response){
		// 			if(this.isMounted()){
		// 				this.setState({
		// 					name: _response.name
		// 				})
		// 			}
		// 		}.bind(this));
		// 	},
		// 	render: function(){
		// 		return(
		// 			<div>
		// 				<h2>my name is {this.state.name}</h2>
		// 			</div>
		// 		);
		// 	}
		// });
		// ReactDOM.render(<Component5/>, document.getElementById('div2'));	

		// //div3 综合案例
		var Button = React.createClass({
		  getInitialState: function() {
		  	console.log('state');
		  	//state
		    return {
		      data:0
		    };
		  },
		  getDefaultProps() {
		  	console.log('props');
		  	return {
		  		data: 0
		  	}
		  },
		  setNewNumber: function() {
		  	//reset state
		  	//当 state 发生改变的时候，state 对应的组件会重新挂载
		  	//将 state 绑定到对应的组件
		    this.setState({data: this.state.data + 1})
		  },
		  render: function () {
		  		var content;
		  		if(this.state.data > 0 && this.state.data % 2 == 0){
		  			content = <Content myNumber = {this.state.data}></Content>;
		  		} else {
		  			content = <h3>{this.state.data}</h3>;
		  		}
		      	return (
		         	<div>
		            	<button onClick = {this.setNewNumber}>INCREMENT</button>
		            	{content}
		         	</div>
		      	);
		    }
		})


		var Content = React.createClass({
		  componentWillMount:function() {
		  	//
		      console.log('Component WILL MOUNT!')
		  },
		  componentDidMount:function() {
		  	//$(function(){})
		       console.log('Component DID MOUNT!')
		  },
		  componentWillReceiveProps:function(newProps) {
		  	console.log(newProps)
		        console.log('Component WILL RECEIVE PROPS!')
		  },
		  shouldComponentUpdate:function(newProps, newState) {
		        return true;
		  },
		  componentWillUpdate:function(nextProps, nextState) {
		        console.log('准备更新组件');
		  },
		  componentDidUpdate:function(prevProps, prevState) {
		        console.log('组件已经更新')
		  },
		  componentWillUnmount:function() {
		         console.log('Component WILL UNMOUNT!')
		  },
		 
		    render: function () {
		      return (
		        <div>
		          <h3>{this.props.myNumber}</h3>
		        </div>
		      );
		    }
		});
	
		ReactDOM.render(
		   <div>
		      <Button />
		   </div>,
		  document.getElementById('div3')
		);		
	</script>
</body>
</html>